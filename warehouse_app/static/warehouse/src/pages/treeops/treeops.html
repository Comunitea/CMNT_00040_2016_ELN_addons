<!--
  Generated template for the TreepickPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>
  
  <ion-navbar color="primary">
      <button ion-button icon-only menuToggle>
        <ion-icon name="menu"></ion-icon>
      </button>
      <ion-title>{{ pick['name']}} [{{ pick['remaining_ops'] }} / {{pick['pack_operation_count']}}]</ion-title>
      <ion-buttons end>
          
        <button ion-button (click)="reorder_picks()">
          <ion-icon name="git-compare"></ion-icon>
        </button>
      
        <button ion-button (click)="goHome()">
          <ion-icon name="home"></ion-icon>
        </button>

      </ion-buttons>
  </ion-navbar>        
  <!--ion-item no-lines class='noPadding'>   show_in_PDA
    <ion-label class='noPadding' color="primary"> {{ pick.picking_type_id_name}} </ion-label>
  </ion-item-->
  
  <ion-item-group>
    <ion-item no-lines *ngIf="!cargar">   
        <ion-badge item-end color='odoo' (click)="seeAll()">{{whatOps}}</ion-badge>
        <ion-badge item-end (click)="doTransfer(pick.id)" [hidden]='pick.state == "done" || pick.done_ops == 0' color='odoo'>Validar</ion-badge>
      
        <!--button ion-button item-end (click)="doAssign(false)" [hidden]='pick.user_id'>Liberar</button-->
        <ion-badge item-end (click)="doAssign(false)" [hidden]='!pick.user_id' color='odoo'>Liber</ion-badge>
        <ion-badge item-end (click)="doAssign(pick.user_id.id)" [hidden]='pick.user_id' color='odoo'>Asignar(me)</ion-badge>
        <!--button ion-button item-end (click)="refresh(pick.id)">Refrescar</button-->
    </ion-item>
    <ion-item no-lines *ngIf="!cargar">   
        <ion-badge item-end color="light" (click)="openLocation(pick.location_id && pick.location_id.id)">
          {{pick['location_id'] && pick.location_id.name}}
        </ion-badge>       
        <ion-badge item-end color="light" (click)="openLocation(pick.location_dest_id && pick.location_dest_id.id)">
          {{ pick['location_dest_id'] && pick.location_dest_id.name}}
        </ion-badge>          
        <ion-badge item-end color="primary">{{pick.state && pick.state.name}} </ion-badge>
    </ion-item>
  </ion-item-group> 
</ion-header>

<ion-content nopadding>
  <div *ngIf="cargar" style="text-align: center" no-lines >    
    <ion-spinner name="circles"></ion-spinner><br>
    <b>Cargando...</b>
  </div>
  <ion-item-group>
     <ion-item no-lines style="height: 50px"></ion-item>
     <ion-item no-lines></ion-item>
  </ion-item-group>  
 
   
  <ion-list *ngIf="pick && !cargar" class="all0">
    <stock-operation *ngFor="let item of pick.pack_operation_ids; let i = index" [stock_operation]="item" [pick] = 'pick' [whatOps]="whatOps" (notify) = "doOp(i, item.id, $event)"
        [hidden]="whatOps=='Pendientes' && item.pda_done || whatOps=='Realizadas' && !item.pda_done">
    </stock-operation>
  </ion-list>
   

  </ion-content>
  <ion-footer>
      <form [formGroup]="treeForm" class ="alignBottom">
     <ion-item  >
        <ion-label color="odoo" item-start>Scan: </ion-label>
        <ion-input #scanPackage [formControl]="treeForm.controls['scan']" type="text" name="scan" placeholder = "Scan"  autofocus></ion-input>
       
        <button ion-button icon-only item-end clear (click)="submitScan()">
          <ion-icon name="barcode"></ion-icon>
        </button>
      </ion-item>   
    </form>
  </ion-footer>
      