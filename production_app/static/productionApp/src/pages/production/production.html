<ion-header>

    <ion-navbar color="primary">
        <ion-title><span class="custom-font-size">Producción</span></ion-title>
        <ion-buttons end>
            <button ion-button full (click)="showConsumptions()">
                <ion-icon name="clipboard"></ion-icon>
            </button>
            <button ion-button (click)='openUsersModal()'>
                <ion-icon name="people"></ion-icon>
            </button>
            <button ion-button (click)='reloadProduction()'>
                <ion-icon name="refresh"></ion-icon>
            </button>
            <button ion-button (click)='logOut()'>
                <ion-icon name="log-out"></ion-icon>
            </button>
        </ion-buttons>
    </ion-navbar>
</ion-header>

<ion-content padding>
    <div class="content-full">
        <div class="content-one">
            <ion-item [hidden]='prodData.workcenter' color="danger">No hay línea seleccionada</ion-item>
            <div class="grid1">
                <ion-grid text-center>
                    <ion-row>
                        <ion-col width-33>
                            <div class="info-tittle">Centro trabajo</div>
                        </ion-col>
                        <ion-col width-33>
                            <div class="info-tittle">Producción</div>
                        </ion-col>
                        <ion-col width-33>
                            <div class="info-tittle">Operario activo</div>
                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col width-33>
                            <div class="info-content">{{prodData.workcenter.name}}</div>
                        </ion-col>
                        <ion-col width-33>
                            <div class="info-content">{{prodData.production}}</div>
                        </ion-col>
                        <ion-col width-33>
                            <div class="info-content">{{prodData.getActiveOperatorName()}}</div>
                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col width-100>
                            <div class="info-tittle">Producto</div>
                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col width-100>
                            <div class="info-content">{{prodData.product}}</div>
                            <div class="info-content" *ngIf="prodData.production_uos_qty !== 0">{{prodData.production_qty}} {{prodData.uom}} / {{prodData.production_uos_qty}} {{prodData.uos}}</div>
                            <div class="info-content" *ngIf="prodData.production_uos_qty === 0">{{prodData.production_qty}} {{prodData.uom}}</div>
                        </ion-col>
                    </ion-row>
                    <ion-row>
                        <ion-col width-100>
                            <div class="info-tittle">Operarios</div>
                        </ion-col>
                    </ion-row>
                    <ion-row *ngIf="prodData.getLogInOperators().length !== 0">
                        <ion-col width-100>
                            <div class="info-content">{{prodData.getOperatorNames()}}</div>
                        </ion-col>
                    </ion-row>
                    <ion-row *ngIf="prodData.getLogInOperators().length === 0">
                         <ion-col width-100>
                            <div class="info-warning">SIN OPERARIOS LOGUEADOS</div>
                        </ion-col>
                    </ion-row>
                </ion-grid>
            </div>
        </div>
        <div  class="content-two">
            <ion-grid>
                <ion-row>
                    <ion-col text-center>
                        <span class="info-tittle">Tiempo transcurrido</span>
                    </ion-col>
                    <ion-col text-center width-50 *ngIf="prodData.state === 'stopped'">
                        <span class="info-tittle-red">Tiempo en parada</span>
                    </ion-col>
                </ion-row>
                <ion-row *ngIf="(prodData.state != 'waiting')">
                    <ion-col>
                        <button ion-button large block clear><timer [timeInSeconds]="0"></timer></button>
                    </ion-col>
                    <ion-col width-50 [ngClass]="hidden_class">
                        <button [ngClass]="hidden_class" ion-button large block clear color="danger"><timer [timeInSeconds]="0"></timer></button>
                    </ion-col>
                </ion-row>
                <ion-row *ngIf="(prodData.state !== 'started') && (prodData.state !== 'stopped')">
                    <ion-col col-12>
                        <!-- PANTALLA INICIAL-->
                        <button class="btn" *ngIf="prodData.state == 'waiting'" (click)="confirmProduction()">
                            Confirmar producción
                        </button>
                        <!-- PANTALLA 2-->
                        <button class="btn" *ngIf="prodData.state == 'confirmed'" (click)="setupProduction()">
                            Comenzar preparación
                        </button>
                    </ion-col>

                        <!-- PANTALLA 3-->
                    <ion-col col-3>
                         <button class="btn2" color="danger" *ngIf="prodData.state == 'setup'" (click)="stopProduction()">
                            Parar producción
                        </button>
                    </ion-col>
                    <ion-col col-9>
                        <button class="btn" *ngIf="prodData.state == 'setup'" (click)="startProduction()">
                            Empezar producción
                        </button>
                    </ion-col>
                    <ion-col col-12>
                        <!-- PANTALLA 5-->
                        <button class="btn"*ngIf="prodData.state == 'cleaning'" (click)="finishProduction()">
                            Finalizar producción
                        </button>
                        <button class="btn2" color="danger" *ngIf="prodData.state == 'finished'" (click)="loadNextProduction()">
                            Siguiente
                        </button>
                    </ion-col>
                </ion-row>
                <ion-row *ngIf="prodData.state === 'started'">
                    <ion-col width-33>
                        <button class="btn" *ngIf="prodData.state == 'started'" (click)="cleanProduction()">
                            Empezar limpieza
                        </button>
                    </ion-col>
                    <ion-col width-33>
                         <button class="btn2"  color="danger" *ngIf="prodData.state == 'started'" (click)="stopProduction()">
                            Parar producción
                        </button>
                    </ion-col>
                </ion-row>
                <ion-row *ngIf="prodData.state === 'stopped'">
                    <ion-col width-50>
                        <button  class="btn" *ngIf="prodData.state == 'stopped'" (click)="restartProduction()">
                            Reanudar producción
                        </button>
                    </ion-col>
                    <ion-col width-50>
                        <button class="btn" *ngIf="prodData.state == 'stopped'" (click)="restartAndCleanProduction()">
                            Reanudar y empezar limpieza
                        </button>
                    </ion-col>
                </ion-row>
                <ion-row *ngIf="(prodData.state == 'started') || (prodData.state == 'stopped') || (prodData.state == 'cleaning')">
                     <ion-col text-center width-100>
                        <button ion-button round (click)="scrapProduction()" color="dark">
                            Scrap
                        </button>
                    </ion-col>
                </ion-row>
            </ion-grid>
        </div>
    </div>
</ion-content>

<ion-footer>
    <ion-item text-center color ="primary"><span>{{prodData.states[prodData.state]}}</span></ion-item>
</ion-footer>

